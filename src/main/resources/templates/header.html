<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<div th:fragment="header">


  <meta http-equiv="Content-Type" content="text/html; charset=euc-kr" />
  <style>
    body, table, th, td, input {
      font-size: 9pt;
    }
    table th {
      background-color: #efefef;
    }
  </style>
  <script th:inline="javascript">
    /*<![CDATA[*/
    var strLoginID = /*[[${userInfo}]]*/ 'null';

    /*]]>*/
  </script>
  <script>

    POPUP = 0;
    var strLoginPwd = "!alsdnrdl10";
    var RedirectConfMode = 0;
    var UserExten;

    function clearS() {
      var tf = document.forms['iform'];
      tf.Primarychan1.value = "";
      tf.Primarychan2.value = "";
      tf.uidchan21.value = "";
      tf.uidchan22.value = "";
      tf.uidchan11.value = "";
      tf.uidchan12.value = "";
      tf.chan1.value = "";
      tf.chan2.value = "";
      tf.Primarystatus.value = "";
      tf.Secondstatus.value = "";
      tf.inexten.value = "";
      tf.callernumber.value = "";
      tf.callernumber2.value = "";
    }

    function setInfoval(ch1, ch2, iscall, evt, Insp, act) {
      // Function implementation
    }

    function atxfer() {
      document.getElementById('EventClientCtrl').Atxfer(document.forms['iform'].transnum.value);
    }
    function playDtmf() { }
    function answer() {
      document.getElementById('EventClientCtrl').Answer();
    }
    function hangup() {
      document.getElementById('EventClientCtrl').HangUp();
    }
    function hangup2() {
      document.getElementById('EventClientCtrl').HangUpDst();
    }
    function dial() {
      document.getElementById('EventClientCtrl').Click2Call(document.forms['iform'].inputnum.value, "outbound", "");
    }
    function pickup() {
      document.getElementById('EventClientCtrl').PickUp(document.forms['iform'].inputnum.value);
    }
    function redirect() {
      document.getElementById('EventClientCtrl').Transfer(document.forms['iform'].transnum.value);
    }
    function hold(t) {
      if (t == 1)
        document.getElementById('EventClientCtrl').UnHold();
      else
        document.getElementById('EventClientCtrl').Hold();
    }
    function goconference(act) {
      ConferenceAction(document.forms['iform'].chan1.value, document.forms['iform'].chan2.value, document.forms['iform'].inputnum.value, "FHCRMCONF", act);
    }
    function sendcmd(cmd) {
      SIPCommand(cmd);
    }
    function sendsms() {
      var type = "0";
      var typeinfo = "0";
      var peers = document.forms['iform'].smspeers.value;
      var msg = document.forms['iform'].smsmsg.value;
      document.getElementById('EventClientCtrl').SendSMS(type, typeinfo, peers, msg);
    }
    function getpeerinfo(peers) {
      document.getElementById('EventClientCtrl').GetPeerInfo(peers);
    }
    function setuserinfo(type, value) {
      document.getElementById('EventClientCtrl').SetUserInfo(type, value);
    }
    function SendPeerMsg(strType, strInfo, strPeers, strMsg) {
      document.getElementById('EventClientCtrl').SendPeerMsg(strType, strInfo, strPeers, strMsg);
    }
    function getCallHistory(cat, inout, start, end, search) {
      document.getElementById('EventClientCtrl').GetCallHistory(cat, inout, start, end, search);
    }
    function getRecordList(inout, start, end, search) {
      document.getElementById('EventClientCtrl').GetRecordList(inout, start, end, search);
    }
    function GetListConfMember(room) {
      document.getElementById('EventClientCtrl').GetListConfMember(room);
    }
    function RedirectConference() {
      RedirectConfMode = 1;
      document.getElementById('EventClientCtrl').RedirectConference("conf111");
    }
    function InviteConference(peers) {
      document.getElementById('EventClientCtrl').InviteConference("conf111", peers);
    }
    function RemoveConference(room, channels) {
      document.getElementById('EventClientCtrl').RemoveConference(room, channels);
    }
    function CallWithConference(peers) {
      document.getElementById('EventClientCtrl').CallWithConference("V111", peers);
    }
    function SetForward(use, type, num, start, end, etc) {
      document.getElementById('EventClientCtrl').SetForward(use, type, num, start, end, "");
    }
    function MagAddr(type, keyidx, gname, pname, tel1, tel2, tel3, tel4, tel5, def, memo) {
      document.getElementById('EventClientCtrl').MagAddrList(type, keyidx, gname, pname, tel1, tel2, tel3, tel4, tel5, def, memo);
    }
    function hangupChannel(chan) {
      document.getElementById('EventClientCtrl').HangupChannel(chan);
    }
    function GetStatusPeers(peers, option) {
      document.getElementById('EventClientCtrl').GetStatusPeers(peers, option);
    }
    window.focus();
  </script>

<body  onload="document.getElementById('LOGIN_ID').value = strLoginID; sConnect();">

  <nav class="main-header navbar navbar-expand navbar-white navbar-light">
    <ul class="navbar-nav">
      <li class="nav-item">
        <a class="nav-link" data-widget="pushmenu" href="#" role="button"><i class="fas fa-bars"></i></a>
      </li>
      <li class="nav-item d-none d-sm-inline-block">
        <a href="#" class="nav-link">WIO</a><span class="call_font"> 내선:<span th:text="${userInfo}"></span><span id="connectionStatus"></span></span>
      </li>

    </ul>
    <form name="iform" id="iform" style="margin:0;padding:0;">
      <li> 통화채널 (로그인상태:<span id="loginStatus" name="loginStatus">접속을 클릭해 주세요</span>)
        <table border="0" width="100%" cellpadding="0" cellspacing="0">
          <td bgcolor="#acacac">
            <table border="0" width="100%" cellpadding="2" cellspacing="1">
              <tr bgcolor="#FFFFFF">
                <th>Primarychan</th>
                <td><input type="text" name="Primarychan1"><input type="text" name="uidchan11" size="10"></td>
                <td><input type="text" name="Primarychan2"><input type="text" name="uidchan12" size="10"></td>
                <td><input type="text" name="callernumber"><input type="text" name="Primarystatus" size="5"></td>
                <td>
                  <input type="button" name="chanHangupBtn1" id="HangupBtn1" value="끊기" onClick="hangupChannel(this.form.Primarychan1.value)">
                  <input type="button" name="chanHangup2Btn" id="Hangup2Btn" value="상대끊기" onClick="hangupChannel(this.form.Primarychan2.value)">
                </td>
              </tr>
              <tr bgcolor="#FFFFFF">
                <th>Secondchan</th>
                <td><input type="text" name="chan1"><input type="text" name="uidchan21" size="10"></td>
                <td><input type="text" name="chan2"><input type="text" name="uidchan22" size="10"></td>
                <td><input type="text" name="callernumber2"><input type="text" name="Secondstatus" size="5"></td>
                <td><input type="button" value="clear" onClick="clearS()"></td>
              </tr>
            </table>
          </td>
        </table>
        <span id="InfoView" style="display:none;">
        <li>OutMessage:<input type="text" name="ch1"><input type="text" name="ch2">/
          <input type="text" name="uid1"><input type="text" name="uid2">
          callernumber:<input type="text" name="inexten">
          backchan:<input type="text" name="backchan1">/<input type="text" name="backchan2">( <input type="text" name="iscall">)
      </span>
      <li> 접속기능
        <table border="0" width="100%" cellpadding="0" cellspacing="0">
          <td bgcolor="#acacac">
            <table border="0" width="100%" cellpadding="2" cellspacing="1">
              <tr bgcolor="#efefef">
                <th>ID:<input type="text" size="14" id="LOGIN_ID" name="LOGIN_ID" value="">
                  PASS:<input type="password" size="7" id="LOGIN_PWD" name="LOGIN_PWD" value="">
                </th>
                <th>ServerIP:<input type="text" size="12" id="SERVER_IP" name="SERVER_IP" value="203.233.92.82">
                  <input type="checkbox" name="SetSeed" id="SetSeed" checked>Seed
                  <input type="button" id="BtnCONN" name="BtnCONN" onClick="return sConnect();" value="접속">
                </th>
              </tr>
            </table>
          </td>
        </table>
      <li> <a href="#" onClick="return viewMenu('CtiTable');">CTI기능</a>
        <table border="0" width="100%" cellpadding="0" cellspacing="0" id="CtiTable" name="CtiTable" style="display:none;">
          <td bgcolor="#acacac">
            <table border="0" width="100%" cellpadding="3" cellspacing="0">
              <tr bgcolor="#FFFFFF">
                <th width="150" align="right">전화걸기</th>
                <td>
                  대상번호:<input type="text" name="inputnum" size="10">
                  <input type="button" name="DialBtn" id="DialBtn" value="전화걸기" onClick="dial()">
                  <input type="button" name="PickupBtn" id="PickupBtn" value="당겨받기" onClick="pickup()">
                </td>
              </tr>
              <tr bgcolor="#FFFFFF">
                <th align="right">동시회의통화</th>
                <td>
                  회의참석자번호:<input type="text" size="14" name="WithConfInviteNum" id="WithConfInviteNum" value="">
                  <input type="button" name="WithConfBtn1" id="WithConfBtn1" value="동시회의통화시작" onClick="CallWithConference(WithConfInviteNum.value)">
                  <input type="button" name="CaonfStatusBtn1" id="CaonfStatusBtn1" value="통화상태" onClick="GetStatusPeers(WithConfInviteNum.value,'')">
                </td>
              </tr>
              <tr bgcolor="#FFFFFF">
                <th align="right">Ring시</th>
                <td>
                  <input type="button" name="AnsBtn" id="AnsBtn" value="전화받기" onClick="answer()">
                  <input type="button" name="HangupBtn" id="HangupBtn" value="수신거부" onClick="hangup()">
                </td>
              </tr>
              <tr bgcolor="#FFFFFF">
                <th align="right">통화시</th>
                <td>
                  <input type="button" name="HangupBtn1" id="HangupBtn1" value="끊기" onClick="hangup()">
                  <input type="button" name="Hangup2Btn" id="Hangup2Btn" value="상대끊기" onClick="hangup2()">
                  <input type="button" name="HoldBtn" id="HoldBtn" value="Hold" onClick="hold()">
                  <input type="button" name="UnHoldBtn" id="UnHoldBtn" value="UnHold" onClick="hold(1)">
                  <input type="button" name="RecordBtn" id="RecordBtn" value="StartRecord" onClick="document.getElementById('EventClientCtrl').StartRecord()">
                  <input type="button" name="RecordBtn1" id="RecordBtn1" value="StopRecord" onClick="document.getElementById('EventClientCtrl').StopRecord()">
                  <li>돌려줄번호:<input type="text" name="transnum" size="10" value="">
                    <input type="button" name="TransBtn" id="TransBtn" value="통화후전달" onClick="atxfer()">
                    <input type="button" name="RedirectBtn" id="RedirectBtn" value="전환" onClick="redirect()">
                  <li>회의통화:<input type="button" name="ConfBtn" id="ConfBtn" value="통화중회의" onClick="RedirectConference()">
                    <input type="text" size="14" name="ConfInviteNum" id="ConfInviteNum" value="">
                    <input type="button" name="ConfBtn1" id="ConfBtn1" value="초대통화" onClick="InviteConference(ConfInviteNum.value)">
                </td>
              </tr>
            </table>
          </td>
        </table>
        <script>
          function viewMenu(id, v) {
            var obj = document.getElementById(id);
            obj.style.display = (obj.style.display == "" && v != "1") ? "none" : "";
            return false;
          }
        </script>
      <li> <a href="#" onClick="return viewMenu('OamTable');">OAM기능</a>
        <table border="0" width="100%" cellpadding="0" cellspacing="0" id="OamTable" name="OamTable" style="display:none;">
          <td bgcolor="#acacac">
            <table border="0" width="100%" cellpadding="2" cellspacing="1">
              <tr bgcolor="#FFFFFF">
                <th width="150" align="right">SMS</th>
                <td>
                  수신번호:<input type="text" name="smspeers" id="smspeers" value="0192330907,07075490775">
                  메세지:<input type="text" name="smsmsg" id="smsmsg" value="우리는 민족">
                  <input type="button" name="SendSMSBtn" id="SendSMSBtn" value="SendSMS" onClick="sendsms()">
                </td>
              </tr>
              <tr bgcolor="#FFFFFF">
                <th align="right">SendPeerMsg</th>
                <td>
                  수신번호:<input type="text" name="msgpeers" id="msgpeers" value="3456,3457">
                  메세지:<input type="text" name="peersmsg" id="peersmsg" value="우리는 민족">
                  <input type="button" name="PeerMsgBtn" id="PeerMsgBtn" value="알림전송" onClick="SendPeerMsg('0','',msgpeers.value,peersmsg.value)">
                </td>
              </tr>
              <tr bgcolor="#FFFFFF">
                <th align="right">PEERINFO</th>
                <td><input type="text" name="infopeer" id="infopeer" value="3021,3022,3033">
                  <input type="button" name="InfoPeerBtn" id="InfoPeerBtn" value="InfoPEER" onClick="getpeerinfo(this.form.infopeer.value)">
                  <input type="button" name="peerStatusBtn1" id="peerStatusBtn1" value="통화상태" onClick="GetStatusPeers(this.form.infopeer.value,'')">
                </td>
              </tr>
              <tr bgcolor="#FFFFFF">
                <th align="right">착신전환</th>
                <td> 착신전환번호:<input type="text" name="forwardNum" id="forwardNum" size="12" value="07075993456">
                  <input type="button" name="BtnForward" value="착전설정" onClick="SetForward('1','0',forwardNum.value,'','','')">
                  <input type="button" name="BtnForward" value="착전해제" onClick="SetForward('0','','','','','')">
                </td>
              </tr>
              <tr bgcolor="#FFFFFF">
                <th align="right">CallLog</th>
                <td>
                  <select name="callinout">
                    <option value="0"> 수신
                    <option value="1"> 발신
                    <option value="9"> 건수
                  </select>
                  <select name="callcat">
                    <option value="1"> 개인
                    <option value="0"> 도메인전체
                  </select>
                  기간:<input type="text" name="callstart" size="8" id="callstart" value="20110901">
                  ~<input type="text" name="callend" id="callend" size="8" value="20110930">
                  <select name="callsearch">
                    <option value="9"> 전체
                    <option value="0"> 내부
                    <option value="1"> 시내/외
                    <option value="2"> 이동전화
                    <option value="5"> 국제전화
                  </select>
                  <input type="button" name="HistoryBtn" id="HistoryBtn" value="History" onClick="getCallHistory(this.form.callcat.value,this.form.callinout.value,this.form.callstart.value,this.form.callend.value,this.form.callsearch.value)">
                </td>
              </tr>
              <tr bgcolor="#FFFFFF">
                <th align="right">녹취목록(DCS용)</th>
                <td>
                  <select name="recordinout">
                    <option value="0"> 전체
                    <option value="1"> 수신
                    <option value="2"> 발신
                  </select>
                  기간:<input type="text" name="recordstart" size="8" id="recordstart" value="20110901">
                  ~<input type="text" name="recordend" id="recordend" size="8" value="20110930">
                  고객번호검색<input type="text" name="recordsearch" id="recordsearch" size="8" value="">
                  <input type="button" name="RecordBtn" id="RecordBtn" value="Record" onClick="getRecordList(this.form.recordinout.value,this.form.recordstart.value,this.form.recordend.value,this.form.recordsearch.value)">
                </td>
              </tr>
              <tr bgcolor="#FFFFFF">
                <th align="right">주소록(DCS용)</th>
                <td>
                  명령:<select name="addrType" onChange="addrinfo.style.display=(this.value =='LIST')?'none':'';addrinfo1.style.display=(this.value =='LIST')?'none':''">
                  <option value="LIST">목록
                  <option value="ADD">추가
                  <option value="MOD">수정
                  <option value="DEL">삭제
                </select>
                  <span id="addrinfo" style="display:none;">
                    keyidx:<input type="text" name="keyidx" id="keyidx" size="12" value="">
                    그룹명:<input type="text" name="grpname" id="grpname" size="12" value="친구">
                    이름:<input type="text" name="pname" id="pname" size="12" value="나의친구">
                  </span>
                  핸드폰:<input type="text" name="telnum1" id="telnum1" size="12" value="">
                  <span id="addrinfo1" style="display:none;">
                    집전화:<input type="text" name="telnum2" id="telnum2" size="12" value="">
                    사무실:<input type="text" name="telnum3" id="telnum3" size="12" value="">
                    팩스:<input type="text" name="telnum4" id="telnum4" size="12" value="">
                    기타:<input type="text" name="telnum5" id="telnum5" size="12" value="">
                    기본번호:<select name="defnum" id="defnum">
                      <option value="1">핸드폰
                      <option value="2">집전화
                      <option value="3">사무실
                      <option value="4">팩스
                      <option value="5">기타
                    </select>
                    메모:<input type="text" name="memo" id="memo" size="12" value="">
                  </span>
                  <input type="button" name="addrbtn" value="주소록" onClick="MagAddr(this.form.addrType.value,this.form.keyidx.value,this.form.grpname.value,this.form.pname.value,this.form.telnum1.value,this.form.telnum2.value,this.form.telnum3.value,this.form.telnum4.value,this.form.telnum5.value,this.form.defnum.value,this.form.memo.value);">
                </td>
              </tr>
            </table>
          </td>
        </table>
        <br>
        <input type="button" onClick="document.getElementById('recvlog').value='';" value="ClearLog"><br>
        <textarea style="width:100%;height:350px;" name="recvlog" id="recvlog"></textarea>
        <div name="dispinfo" id="dispinfo" style="width:100%;"></div>
    </form>
  </nav>

  <!-- Additional body content from dcs_lgapi.html -->



<script id="OnSendRingEvent" for="EventClientCtrl" event="SendRingEvent(bstrRingEvent)">
  parseMsg(bstrRingEvent);
</script>
<script id="OnSendChannelListEvent" for="EventClientCtrl" event="SendChannelListEvent(bstrChannelList)">
  parseMsg(bstrChannelList);
</script>
<script id="OnSendChannelOutEvent" for="EventClientCtrl" event="SendChannelOutEvent(bstrChannelOut)">
  parseMsg(bstrChannelOut);
</script>
<script id="OnSendLoginResultEvent" for="EventClientCtrl" event="SendLoginResultEvent(bstrLoginResult)">
  parseMsg(bstrLoginResult);
</script>
<script id="OnSendCommandResultEvent" for="EventClientCtrl" event="SendCommandResultEvent(bstrCommandResult)">
  CommandResultEvent(bstrCommandResult);
</script>
<script id="OnSendNetworkErrorEvent" for="EventClientCtrl" event="SendNetworkErrorEvent()">
  document.getElementById('EventClientCtrl').DisconnectServer();
  document.getElementById('BtnCONN').value = "접속";
  document.getElementById('loginStatus').innerHTML = "접속종료";

  viewMenu('CtiTable');
  ISCON = 0;
  document.getElementById('recvlog').value += "disconnected......\n";
</script>
<script id="OnSendEtcEvent" for="EventClientCtrl" event="SendEtcEvent(strEventName, strEventValue)">
  EtcEvent(strEventName, strEventValue);
</script>
<script id="OnSendSMSEvent" for="EventClientCtrl" event="SendSMSEvent(strEventValue)">
  EtcEvent("SendSMSEvent", strEventValue);
</script>
<script id="OnSendPeerMsgEvent" for="EventClientCtrl" event="SendPeerMsgEvent(strEventValue)">
  EtcEvent("SendPeerMsgEvent", strEventValue);
</script>
<script id="OnSendCmdErrorEvent" for="EventClientCtrl" event="SendCmdErrorEvent(strCmd, strEventValue)">
  if (strCmd != "Connect") {
    alert("CmdError: cmd(" + strCmd + ")" + strEventValue);
  }
  EtcEvent("SendDtmfEvent", strEventValue);
</script>

<script>
  var OutStr = "<object style='display:;' ID='EventClientCtrl' WIDTH=100 HEIGHT=100 CLASSID='CLSID:86019F2F-2899-4C4C-A6FE-24CFF7CD6D4C'  codebase='/activeXLGUBaseOpenApi_1.0.1.21.cab#version=1,0,1,21'></object>";
  document.writeln(OutStr);

  var ISCON = 0;
  var ISCALL = 0;
  var STAT = 0;
  var READY = 0;
  var timerID = null;
  var isExtened = 0;
  var PhoneNum = "";
  var PhoneCaller = "";
  var popuptime = 0;

  function sConnect(ctype) {
    if (!READY) {
      alert("컨트롤이 시작되지 못했습니다.");
      document.getElementById('connectionStatus').innerText = "접속 안됨";
      return false;
    }
    if (ISCON) {
      document.getElementById('EventClientCtrl').DisconnectServer();
      ISCON = 0;
    } else {
      strLoginID = document.getElementById('LOGIN_ID').value;
      strLoginPwd = document.getElementById('LOGIN_PWD').value;
      strServerIP = document.getElementById('SERVER_IP').value;
      if (document.getElementById('SetSeed').checked)
        document.getElementById('EventClientCtrl').SetSeedEncryption();
      document.getElementById('EventClientCtrl').LoginServer(strLoginID, strLoginPwd, strServerIP);
    }
    CheckConnect();
    return false;
  }

  function CheckConnect() {
    if (document.getElementById('EventClientCtrl') != null) {
      var bConnect = document.getElementById('EventClientCtrl').IsConnected();
      alert("연결상태 : " + bConnect);
    }
  }

  if (document.getElementById('EventClientCtrl').readyState == 4) {
    READY = 1;
  }


  function EtcEvent(strEventName, strEventValue) {
    document.getElementById('recvlog').value += strEventValue + "\n";
    var msgs = strEventValue.split("|");
    var Insp = new Object();
    Insp["EVENT"] = msgs[0];

    if (Insp["EVENT"] == "CMDRESULTEND") { }
    if (Insp["EVENT"] == "CONFERENCEEVENT") {
      for (var i = 1; i < msgs.length; i++) {
        var keyval = msgs[i].split(":");
        Insp[keyval[0]] = keyval[1];
      }
      if (Insp["CMD"] == "CONFMEMBERDEL") {
        alert(Insp["CHANNEL"]);
        setInfoval(Insp["CHANNEL"], "", 0, "CHANNELOUT", Insp, "");
      }
    }
  }

  function parseMsg(msg) {
    var recvlogElement = document.getElementById('recvlog');
    recvlogElement.value += msg + "\n";

    var msgs = msg.split("|");
    var Insp = new Object();
    Insp["EVENT"] = msgs[0];
    var disp = "";
    for (var i = 1; i < msgs.length; i++) {
      var keyval = msgs[i].split(":");
      Insp[keyval[0]] = keyval[1];
    }

    var caller = Insp["CALLERID"];
    var caller1 = Insp["CALLER1ID"];
    var caller2 = Insp["CALLER2ID"];
    var channel1 = Insp["CHANNEL1"];
    var channel2 = Insp["CHANNEL2"];
    var msg = Insp["MSG"];
    var status = Insp["STATUS"];

    if (Insp["EVENT"] == "CMDRESULT") {
      // Handle CMDRESULT event
    } else if (Insp["EVENT"] == "RINGEVENT") {
      setInfoval(Insp["CHANNEL"], Insp["RECHANNEL"], Insp["ISDIAL"], Insp["EVENT"], Insp, 1);
    } else if (Insp["EVENT"] == "LOGINRESULT") {
      if (status == "1") {
        viewMenu('CtiTable', 1);
        document.getElementById('BtnCONN').value = "종료";
        var linfos = msg.split(",");
        var PhoneNum = linfos[0];
        var UserExten = Insp["EXTEN"];
        var PhoneCaller = linfos[1];
        ISCON = 1;
        document.getElementById('loginStatus').innerHTML = "로그인성공:" + PhoneNum + "/" + PhoneCaller;
        document.getElementById('connectionStatus').innerText = "대기중";
      } else {
        document.getElementById('EventClientCtrl').DisconnectServer();
        document.getElementById('loginStatus').innerHTML = "로그인실패";
        document.getElementById('connectionStatus').innerText = "접속 안됨";
        alert("LOGIN 실패:" + msg);
      }
    } else if (Insp["EVENT"] == "CHANNELLIST") {
      setInfoval(Insp["CHANNEL1"], Insp["CHANNEL2"], ISCALL, Insp["EVENT"], Insp, 2);
    } else if (Insp["EVENT"] == "CHANNELOUT") {
      setInfoval(Insp["CHANNEL"], Insp["RECHANNEL"], "", Insp["EVENT"], Insp, 0);
    }
    return false;
  }

  function clearInfo() {
    document.getElementById('dispinfo').innerHTML = "";
  }

  function OnPageLoad() {
    if (document.getElementById('EventClientCtrl') != null) {
      document.getElementById('LOGIN_ID').value = strLoginID;
      document.getElementById('LOGIN_PWD').value = strLoginPwd;
    } else {
      alert("ActiveX Control Error");
    }
  }

  function SIPCommand(strCommand) {
    if (strCommand != "" && strCommand != "undefined" && READY == 1 && document.getElementById('EventClientCtrl') != null) {
      document.getElementById('EventClientCtrl').SendSIPCommand("CMD|" + strCommand);
    }
    return false;
  }

  function CommandResultEvent(bstrCommandResult) {
    document.getElementById('recvlog').value += bstrCommandResult + "\n";
  }

  window.onload = OnPageLoad;
</script>

<script th:inline="javascript">
  /*<![CDATA[*/
  var userInfoJson = /*[[${userInfoJson}]]*/ 'null';
  console.log("User Info:", JSON.parse(userInfoJson));
  /*]]>*/
</script>
</div>
</body>
</div>
</html>
